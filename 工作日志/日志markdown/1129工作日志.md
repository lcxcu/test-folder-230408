### 数据处理与结果：
##### 代码：
```python
import pandas as pd
import warnings
warnings.filterwarnings('ignore') # 忽略警告

# 读取 股票 证券代码|交易时间|涨跌幅
data_stock = pd.read_excel(r"C:/Users/jc/Documents/大学/0大三其他/"+
                           "_NEW金融数据挖掘课题/PyProgram/_eanring announcement"+
                           "/日个股回报率文件225335089/TRD_Dalyr.xlsx",
                           header=0,skiprows=[0,2],usecols="A,B,D",
                           dtype={'证券代码':str})
# 读取 财报 证券代码|报告类型|报告公布日期|调整前每股收益|调整后每股收益
data_ea = pd.read_excel(r"C:/Users/jc/Documents/大学/0大三其他"+
                        "/_NEW金融数据挖掘课题/PyProgram/_eanring announcement/"+
                        "年、中、季报基本情况文件011833799/IAR_Rept.xlsx",
                        header=0,skiprows=[0,2],usecols="A,E,F,G",
                        dtype={'证券代码':str})
data_ea  = data_ea.rename(columns={'报告公布日期':'日期'}) 

# 创建表格 存有数据 证券代码|时间（交易时间）|股票-涨跌幅|财报-调前收益|财报-调后收益|可见性(可见时调整为对应季度财报数据)
dict_data = { '证券代码': list(data_stock['证券代码']),
              '日期': list(data_stock['交易日期']),
              '股票-收益率':list(data_stock['涨跌幅'])}
data = pd.DataFrame(dict_data)        
data_all = pd.merge(data, data_ea[['证券代码','日期','调整前每股收益','调整后每股收益']],on = ['证券代码','日期']
                ,how = 'left')
data_all = data_all.set_index(['证券代码'])
data_all=data_all.fillna('0')
# 保存数据
data_all.to_excel('各企业股票与财报数据.xlsx')
```

##### 数据处理结果:
发布日当天数据为财报数据，其余天财报数据为0

![[Pasted image 20221130000413.png]]
![[Pasted image 20221130000524.png]]
